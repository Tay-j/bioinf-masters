library(ape)
tr <- read.tree("John/University/Master/Project/Data/COVID/nextstrain/nextstrain_ncov_global_timetree.nwk")
tr_metadata <- read.delim2("John/University/Master/Project/Data/COVID/nextstrain/nextstrain_ncov_global_metadata-3.tsv")
# drop.tip
# tr$edge
# tr$tip.label
par(mfrow = c(1, 1))
plot(tr,cex = 0.01)
#tr_pruned <- drop.tip(tr,1:700)
#tr_pruned <- drop.tip(tr,sample(1:length(tr$tip.label),700,replace = FALSE))
set.seed(1)
B.1.1.7 <- tr_metadata[tr_metadata$PANGO.Lineage=="B.1.1.7",]$Strain
B.1.1.7 <- sample(B.1.1.7,20,replace = FALSE)
P.1 <- tr_metadata[tr_metadata$PANGO.Lineage=="P.1",]$Strain
P.1 <- sample(P.1,20,replace = FALSE)
others <- tr_metadata[tr_metadata$PANGO.Lineage!="B.1.1.7",]
others <- others[others$PANGO.Lineage!="P.1",]$Strain
others <- sample(others,200,replace = FALSE)
keep <- c(B.1.1.7,P.1,others)
tr_pruned <- keep.tip(tr,keep)
par(mfrow = c(1, 2))
plot(tr,cex = 0.01)
plot(tr_pruned,cex = 0.01)
write(keep,sequence.txt)
tr <- read.tree("John/University/Master/Project/Data/COVID/nextstrain/nextstrain_ncov_global_timetree.nwk")
getwd()
tr <- read.tree("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/nextstrain_ncov_global_timetree.nwk")
tr_metadata <- read.delim2("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/nextstrain_ncov_global_metadata-3.tsv")
par(mfrow = c(1, 1))
plot(tr,cex = 0.01)
#tr_pruned <- drop.tip(tr,1:700)
#tr_pruned <- drop.tip(tr,sample(1:length(tr$tip.label),700,replace = FALSE))
set.seed(1)
B.1.1.7 <- tr_metadata[tr_metadata$PANGO.Lineage=="B.1.1.7",]$Strain
B.1.1.7 <- sample(B.1.1.7,20,replace = FALSE)
P.1 <- tr_metadata[tr_metadata$PANGO.Lineage=="P.1",]$Strain
P.1 <- sample(P.1,20,replace = FALSE)
others <- tr_metadata[tr_metadata$PANGO.Lineage!="B.1.1.7",]
others <- others[others$PANGO.Lineage!="P.1",]$Strain
others <- sample(others,200,replace = FALSE)
keep <- c(B.1.1.7,P.1,others)
tr_pruned <- keep.tip(tr,keep)
par(mfrow = c(1, 2))
plot(tr,cex = 0.01)
plot(tr_pruned,cex = 0.01)
write(keep,sequence.txt)
write(keep,"sequence.txt")
write(tr_pruned$tip.label,"sequence.txt")
write(tr_pruned$tip.label,"sequences.txt")
sub(".*:", "", tr_pruned$tip.label)
sub("/", "", tr_pruned$tip.label)
sub(".*/", "", tr_pruned$tip.label)
tr_pruned$tip.label
sub(".*/", "", tr_pruned$tip.label)
sub(".*/*", "", tr_pruned$tip.label)
sub(".*,/", "", tr_pruned$tip.label)
sub(".*./", "", tr_pruned$tip.label)
sub("^[^\]*\", "", tr_pruned$tip.label)
sub("^[^/]*/", "", tr_pruned$tip.label)
tr_pruned$tip.label
library(ape)
tr <- read.tree("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/nextstrain_ncov_global_timetree.nwk")
tr_metadata <- read.delim2("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/nextstrain_ncov_global_metadata-3.tsv")
# drop.tip
# tr$edge
# tr$tip.label
par(mfrow = c(1, 1))
plot(tr,cex = 0.01)
#tr_pruned <- drop.tip(tr,1:700)
#tr_pruned <- drop.tip(tr,sample(1:length(tr$tip.label),700,replace = FALSE))
set.seed(1)
B.1.1.7 <- tr_metadata[tr_metadata$PANGO.Lineage=="B.1.1.7",]$Strain
B.1.1.7 <- sample(B.1.1.7,20,replace = FALSE)
P.1 <- tr_metadata[tr_metadata$PANGO.Lineage=="P.1",]$Strain
P.1 <- sample(P.1,20,replace = FALSE)
others <- tr_metadata[tr_metadata$PANGO.Lineage!="B.1.1.7",]
others <- others[others$PANGO.Lineage!="P.1",]$Strain
others <- sample(others,200,replace = FALSE)
tr_pruned <- keep.tip(tr,c(B.1.1.7,P.1,others))
par(mfrow = c(1, 2))
plot(tr,cex = 0.01)
plot(tr_pruned,cex = 0.01)
write(sub("^[^/]*/", "", tr_pruned$tip.label),"sequences.txt")
library(ape)
tr <- read.tree("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/nextstrain_ncov_global_timetree.nwk")
tr_metadata <- read.delim2("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/nextstrain_ncov_global_metadata-3.tsv")
### for gisaid data
set.seed(1)
B.1.1.7 <- as.character(tr_metadata[tr_metadata$PANGO.Lineage=="B.1.1.7",]$gisaid_epi_isl)
#B.1.1.7 <- sample(B.1.1.7,20,replace = FALSE)
P.1 <- as.character(tr_metadata[tr_metadata$PANGO.Lineage=="P.1",]$gisaid_epi_isl)
#P.1 <- sample(P.1,20,replace = FALSE)
others <- tr_metadata[tr_metadata$PANGO.Lineage!="B.1.1.7",]
others <- as.character(others[others$PANGO.Lineage!="P.1",]$gisaid_epi_isl)
write(c(B.1.1.7,P.1,others),"sequences.txt")
tr_metadata <- read.delim2("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/nextstrain_ncov_global_metadata-3.tsv")
tr <- read.tree("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/nextstrain_ncov_global_timetree.nwk")
B.1.1.7 <- as.character(tr_metadata[tr_metadata$PANGO.Lineage=="B.1.1.7",]$gisaid_epi_isl)
### new data
sequence_data <- read.delim2("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
View(sequence_data)
### new data
sequence_data <- read.FASTA("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
View(sequence_data)
head(sequence_data)
View(sequence_data)
### new data
sequence_data <- read.FASTA("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")[,1]
View(sequence_data)
### new data
sequence_data <- read.FASTA("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
sequence_data[,1]
sequence_data[1]
sequence_data[1:5]
B.1.1.7 %in% sequence_data
#B.1.1.7 <- sample(B.1.1.7,20,replace = FALSE)
P.1 <- as.character(tr_metadata[tr_metadata$PANGO.Lineage=="P.1",]$gisaid_epi_isl)
#P.1 <- sample(P.1,20,replace = FALSE)
others <- tr_metadata[tr_metadata$PANGO.Lineage!="B.1.1.7",]
others <- as.character(others[others$PANGO.Lineage!="P.1",]$gisaid_epi_isl)
P.1 %in% sequence_data
others %in% sequence_data
as.list(sequence_data)
### new data
sequence_data <- read.fasta("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
library(Biostrings)
### new data
sequence_data <- readDNAStringSet("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
View(sequence_data)
?read.fasta
### new data
sequence_data <- read.fasta("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
View(sequence_data)
### new data
sequence_data <- read.FASTA("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
?read.FASTA
### new data
sequence_data <- read.dna("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
View(sequence_data)
View(sequence_data)
sequence_data$EPI_ISL_756294
as.list(sequence_data)
test <- as.list(sequence_data)
View(test)
remove(test)
View(sequence_data)
### new data
sequence_data <- read.table("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
View(sequence_data)
### new data
sequence_data <- readDNAStringSet("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
View(sequence_data)
head(sequence_data)
sequence_data[,1]
sequence_data[,2]
View(sequence_data)
### new data
sequence_data <- read.FASTA("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
View(sequence_data)
write(c(B.1.1.7,P.1,others),"get_all_sequences.txt")
typeof(sequence_data)
View(sequence_data)
df <- data.frame(ID=labels(sequence_data),),
seq=sapply(sequence_data, paste, collapse=""))
df <- data.frame(ID=labels(sequence_data),
sp=attr(sequence_data, "species"),
seq=sapply(sequence_data, paste, collapse=""))
View(sequence_data)
### new data
sequence_data <- read.FASTA("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
View(sequence_data)
View(sequence_data)
B.1.1.7[1]
B.1.1.7[1] %in% sequence_data
B.1.1.7[2]
install.packages("phylotools")
library(phytools)
### new data
sequence_data <- get.fasta.name("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
library(phytools)
library(phylotools)
library(phylotools)
remove(sequence_data)
### new data
sequence_names <- get.fasta.name("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
B.1.1.7 %in% sequence_names
P.1 %in% sequence_names
others %in% sequence_names
B.1.1.7[B.1.1.7 %in% sequence_names]
### new data
sequence_names <- get.fasta.name("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
get_B.1.1.7 <- B.1.1.7[B.1.1.7 %in% sequence_names]
get_P.1 <- P.1[P.1 %in% sequence_names]
get_others <- others[others %in% sequence_names]
write(c(get_B.1.1.7,get_P.1,get_others),"get_sequences.txt")
P.1[P.1 %in% sequence_names]
c(get_B.1.1.7,get_P.1,get_others)
length(c(get_B.1.1.7,get_P.1,get_others))
length(get_B.1.1.7)
length(get_P.1)
length(others)
get_others <- others[others %in% sequence_names]
length(get_others)
sequence_names <- get.fasta.name("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
set.seed(1)
get_B.1.1.7 <- B.1.1.7[B.1.1.7 %in% sequence_names]
get_B.1.1.7 <- sample(get_B.1.1.7,20,replace = FALSE)
get_P.1 <- P.1[P.1 %in% sequence_names]
get_P.1 <- sample(get_P.1,20,replace = FALSE)
get_others <- others[others %in% sequence_names]
get_others <- sample(get_others,20,replace = FALSE)
write(c(get_B.1.1.7,get_P.1,get_others),"get_sequences.txt")
sequence_names <- get.fasta.name("D:/Documents/John/University/Master/Project/Data/COVID/nextstrain/all_sequences.fasta")
set.seed(1)
get_B.1.1.7 <- B.1.1.7[B.1.1.7 %in% sequence_names]
get_B.1.1.7 <- sample(get_B.1.1.7,20,replace = FALSE)
get_P.1 <- P.1[P.1 %in% sequence_names]
get_P.1 <- sample(get_P.1,20,replace = FALSE)
get_others <- others[others %in% sequence_names]
get_others <- sample(get_others,200,replace = FALSE)
write(c(get_B.1.1.7,get_P.1,get_others),"get_sequences.txt")
